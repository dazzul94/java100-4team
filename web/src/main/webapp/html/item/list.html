<!DOCTYPE html>
<html>
<head>
<style>
  .m_pointer{
        cursor: pointer;
      }
    </style>
<meta charset="UTF-8">
<style type="text/css">
</style>
<title>리스트</title>
</head>
<body>

<header></header>

        <div class='container'>
        <div class='row justify-content-md-center'>
            <button class="col-sm-5 btn btn-primary"
                onclick="location.href='list'">빌려드립니다</button>
            <div class="col-sm-2"></div>
            <button class="col-sm-5 btn btn-primary"
                onclick="location.href='lendlist'">빌려주세요</button>
        </div>
        </div>
    
<div class="album py-5">
    <div class='container'>
        <div id="list" class='row'>
        
        <div></div>
        
        </div>
        
        
   <nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    <li class="page-item">
    <a id="prevBtn" class="page-link" tabindex="-1">이전</a></li>
        
    <li class="page-item"><a id="currBtn" class="page-link" href="#">1</a></li>
    
    <li class="page-item ">
    <a id="nextBtn" class="page-link" tabindex="0">다음</a></li>
  </ul>
</nav>
        
</div>
</div>
</div>
    
<script src='../../node_modules/jquery/dist/jquery.min.js'></script>
<script src='../../node_modules/popper.js/dist/umd/popper.min.js'></script>
<script src='../../node_modules/bootstrap/dist/js/bootstrap.min.js'></script>
<script src='../../js/fileupload.js'></script>
<script type="text/javascript">

var tbody = $('#list > div'), 
prevBtn = $("#prevBtn"),
currBtn = $("#currBtn"),
nextBtn = $("#nextBtn"),
currPageNo = 1;

$('header').load('../header.html');

load(1);

prevBtn.click(() => {
    load(currPageNo - 1)
});
nextBtn.click(() => {
    load(currPageNo + 1)
});


function load(pageNo, options) {
    
    if (options == undefined) options = {};
    options.pn = pageNo;
    
    $.ajax('../../json/item/list', {
        
        data: options,
        dataType: 'json',
        success: (result) => {
        tbody.html(""); // <tbody> 콘텐츠를 지운다
            
            for (var data of result.list) {
                console.log(data)
                var date = new Date(data.startDate);
                for (var photo of data.photos){
                    var filename = photo.photoName;
                $('<div class="col-md-4 col-sm-6 col-xs-12 m_pointer" onclick="location.href=' + data.itemNo +'">')
                .html(
                        '<div class="card mb-4 box-shadow">' +
                         '<img class="card-img-top"' + 
                                      'data-src="holder.js/300x200?theme=thumb"' +
                                      'alt="Thumbnail [300x200]"' +
                                      'style="height: 225px; width: 100%; display: block;"' +
                                      'src="/download/' + filename + '"' +
                                      'data-holder-rendered="true">' +
                          '<div class="card-body"> ' +
                          '<h3 class="mb-0">'+
                            '<p class="card-text text-truncate">' + data.title + '</p></h3>' +
                            '<p class="card-text mb-1 text-muted" type="date">'+ date+'-' + data.endDate +'</p>' +
                            '<p class="card-text text-truncate">'+ data.name + '</p>' +
                            '<p class="card-text text-truncate">'+ data.content + '</p>' +
                            '<div class="d-flex justify-content-between align-items-center">' + 
                            '</div></div></div>').appendTo($('#list'));
                        }
            }
            
            currPageNo = result.pageNo;
            currBtn.html(currPageNo);
            
            if (result.pageNo == 1) {
                $(prevBtn.parent()).addClass("disabled");
            } else {
                $(prevBtn.parent()).removeClass("disabled");
            }
            
            if (result.lastPageNo == result.pageNo) {
                $(nextBtn.parent()).addClass("disabled");
            } else{
                $(nextBtn.parent()).removeClass("disabled");
            } 
        },
        
        error: () => {
            window.alert('서버 실행 오류!');
        }
    });
    
}

</script>    
    
      
</body>
</html>
