<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style type="text/css">
</style>
<title>리스트</title>
</head>
<body>
<header>  
    </header>

        <div class='container'>
        <div class='row justify-content-md-center'>
            <button class="col-sm-5 btn btn-primary"
                onclick="location.href='list'">빌려드립니다</button>
            <div class="col-sm-2"></div>
            <button class="col-sm-5 btn btn-primary"
                onclick="location.href='lendlist'">빌려주세요</button>
        </div>
        </div>
    
<div class="album py-5">
    <div class='container'>
        <div class='row'>
        
        <div id="list">
        
        
        </div>
        
        
   <nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    <li class="page-item">
    <a id="prevBtn" class="page-link" tabindex="-1">이전</a></li>
        
    <li class="page-item"><a id="currBtn" class="page-link" href="#">1</a></li>
    
    <li class="page-item ">
    <a id="nextBtn" class="page-link" tabindex="0">다음</a></li>
  </ul>
</nav>
        
</div>
</div>
</div>
    
<script src='../../node_modules/jquery/dist/jquery.min.js'></script>
<script src='../../node_modules/popper.js/dist/umd/popper.min.js'></script>
<script src='../../node_modules/bootstrap/dist/js/bootstrap.min.js'></script>
<script src='../../js/fileupload.js'></script>
<script type="text/javascript">

var tbody = $('#list > tbody'), 
prevBtn = $("#prevBtn"),
currBtn = $("#currBtn"),
nextBtn = $("#nextBtn"),
currPageNo = 1;

$('header').load('../header.jsp');

load(1);

prevBtn.click(() => {
    load(currPageNo - 1)
});
nextBtn.click(() => {
    load(currPageNo + 1)
});


function load(pageNo, options) {
    
    if (options == undefined) options = {};
    options.pn = pageNo;
    
    $.ajax('../../json/item/list', {
        
        data: options,
        dataType: 'json',
        success: (result) => {
            
            tbody.html(""); // <tbody> 콘텐츠를 지운다
            
            for (var data of result.list) {
                var date = Date(data.startDate);
                
                $('#list')
                .html(
                    '<div class="card-body">' +
                    '<h3 class="mb-0">' +    
                    '<p class="card-text text-truncate">' + data.name + '</p></h3>' +
                    '<p class="card-text mb-1 text-muted">'+ date.toLocaleDateString + '-' + data.endDate +'</p>' +
                    '<p class="card-text text-truncate">' + data.content + '</p>' +
                    '<p>' + data.name+ '</p><div>');
                
            }
            
            /* $("<div>hello stackoverflow users</div>").appendTo("#targetDIV"); //appendTo: Append at inside bottom
            $("<div>Hello, Stack Overflow users</div>").prependTo("#targetDIV"); //prependTo: Append at inside top
            $("#targetDIV").html("<div>Hello, Stack Overflow users</div>"); //.html(): Clean HTML inside and append
            $("#targetDIV").append("<div>Hello, Stack Overflow users</div>"); //Same as appendTo */
            
            currPageNo = result.pageNo;
            currBtn.html(currPageNo);
            
            if (result.pageNo == 1) {
                $(prevBtn.parent()).addClass("disabled");
            } else {
                $(prevBtn.parent()).removeClass("disabled");
            }
            
            if (result.lastPageNo == result.pageNo) {
                $(nextBtn.parent()).addClass("disabled");
            } else{
                $(nextBtn.parent()).removeClass("disabled");
            }
        },
        
        error: () => {
            window.alert('서버 실행 오류!');
        }
    });
    
}

</script>    
    
      
</body>
</html>
